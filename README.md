# 3D 足球游戏

一个基于 Three.js 和 Cannon.js 开发的 3D 足球射门游戏，具有物理引擎、粒子效果和完整的音频系统。

## 📖 项目简介

这是一款单人足球射门挑战游戏，玩家需要在限定时间内完成指定的进球数来通过关卡。游戏采用现代 Web 技术栈，提供流畅的 3D 游戏体验。

### ✨ 主要特性

- 🎮 **真实的物理引擎**：基于 Cannon.js 实现真实的球体运动和碰撞效果
- 🎨 **3D 渲染**：使用 Three.js 渲染精美的 3D 场景
- 🎯 **关卡系统**：5 个难度递增的关卡，每关有不同的时间限制和目标分数
- ⚽ **方向控制**：根据玩家移动方向控制射门角度
- 🔥 **蓄力系统**：按住空格键蓄力，释放后射门力度更大
- 🎆 **粒子效果**：胜利时的金色烟花和失败时的灰色雨滴效果
- 🎵 **音频系统**：背景音乐和丰富的音效（踢球、进球、胜利、失败）
- ⏸️ **暂停功能**：支持按 ESC 键或点击按钮暂停游戏
- 📊 **实时UI**：显示关卡、时间、得分和蓄力条

## 🎮 游戏操作

### 键盘控制

- **W / ↑** - 向前移动
- **S / ↓** - 向后移动
- **A / ←** - 向左移动
- **D / →** - 向右移动
- **Shift** - 冲刺（加速移动）
- **空格键** - 按住蓄力，释放射门
- **ESC** - 暂停/继续游戏
- **R / Enter** - 重新开始（游戏结束时）

### 游戏规则

1. 每个关卡有时间限制和目标进球数
2. 靠近足球并按住空格键蓄力
3. 移动可以改变射门方向
4. 释放空格键射门
5. 在时间结束前达到目标分数即可进入下一关
6. 时间耗尽且未达标则失败

## 🏗️ 项目结构

```
3d-football/
├── public/                    # 静态资源
│   └── assets/
│       ├── audio/            # 音频文件
│       │   ├── bgm/         # 背景音乐
│       │   └── sfx/         # 音效
│       ├── football.png      # 足球纹理
│       ├── grass.png         # 草地纹理
│       └── naruto_model/     # 角色模型
├── src/                       # 源代码
│   ├── core/                 # 核心系统
│   │   ├── Game.js          # 游戏主逻辑
│   │   └── InputManager.js  # 输入管理
│   ├── entities/             # 游戏实体
│   │   ├── Player.js        # 玩家
│   │   ├── Ball.js          # 足球
│   │   └── Obstacle.js      # 障碍物
│   ├── effects/              # 特效系统
│   │   └── ParticleSystem.js # 粒子系统
│   └── audio/                # 音频系统
│       └── AudioManager.js   # 音频管理器
├── index.html                # HTML 入口
├── style.css                 # 样式表
└── package.json              # 项目配置
```

## 🚀 快速开始

### 环境要求

- Node.js 20.19+ 或 22.12+
- npm 或 yarn

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd 3d-football
```

2. **安装依赖**
```bash
npm install
```

3. **准备音频文件**

在 `public/assets/audio/` 目录下放置以下音频文件：
- `bgm/background.mp3` - 背景音乐
- `sfx/kick.mp3` - 踢球音效
- `sfx/goal.mp3` - 进球音效
- `sfx/victory.mp3` - 胜利音效
- `sfx/defeat.mp3` - 失败音效

4. **启动开发服务器**
```bash
npm run dev
```

5. **打开浏览器**

访问 `http://localhost:5173` 开始游戏

### 构建生产版本

```bash
npm run build
```

构建产物将生成在 `dist/` 目录下。

## 🎯 关卡设置

| 关卡 | 时间限制 | 目标进球数 | 障碍物 |
|------|---------|----------|--------|
| 1    | 30秒    | 3球      | 无     |
| 2    | 45秒    | 6球      | 无     |
| 3    | 60秒    | 10球     | 有     |
| 4    | 60秒    | 12球     | 有     |
| 5    | 50秒    | 15球     | 有     |

## 🔧 技术栈

- **Three.js** (v0.181.2) - 3D 渲染引擎
- **Cannon.js** (v0.20.0) - 物理引擎
- **Vite** (v7.2.4) - 构建工具
- **Vanilla JavaScript** - 核心语言

## 📝 主要功能实现

### 物理系统

- 使用 Cannon.js 实现真实的球体物理
- 配置了球与地面、球门、玩家的碰撞材质
- 低摩擦力和高弹性确保球不会卡在玩家身上

### 射门机制

- 蓄力系统：按住空格键蓄力（0-100%）
- 方向控制：根据玩家移动方向确定射门方向
- 力度计算：蓄力程度影响射门力度（5-25 单位）

### 粒子效果

- 胜利效果：200个金色/彩色粒子向上爆发
- 失败效果：150个灰色/蓝色粒子缓缓落下
- 自动淡出和清理，避免内存泄漏

### 音频系统

- 支持背景音乐循环播放
- 音效克隆技术允许重叠播放
- 音量控制和静音切换功能

## 🎨 自定义配置

### 修改关卡设置

编辑 `src/core/Game.js` 中的 `levels` 数组：

```javascript
this.levels = [
    { time: 30, target: 3 },   // 关卡 1
    { time: 45, target: 6 },   // 关卡 2
    // 添加更多关卡...
];
```

### 调整物理参数

在 `src/entities/Ball.js` 和 `src/entities/Player.js` 中调整物理属性：

```javascript
// 球的质量和阻尼
mass: 0.45,
linearDamping: 0.3,
angularDamping: 0.3

// 接触材质
friction: 0.1,        // 摩擦力
restitution: 0.7      // 弹性
```

### 更换角色模型

将新的 GLTF 模型放在 `public/assets/` 目录下，并修改 `src/entities/Player.js` 中的模型路径。

## 🐛 常见问题

### 音频无法播放

现代浏览器要求用户交互后才能播放音频。点击页面任意位置后背景音乐将自动开始。

### 球卡在玩家身上

已通过设置低摩擦力和高弹性的接触材质解决。如仍有问题，可调整 `Game.js` 中的接触材质参数。

### 帧率过低

- 减少粒子数量（`ParticleSystem.js`）
- 降低阴影质量（`Game.js` 的 `setupLights()`）
- 简化模型复杂度

## 📄 许可证

本项目仅供学习和研究使用。

## 🙏 致谢

- Three.js 社区
- Cannon.js 社区
- Naruto 模型资源

---

**祝游戏愉快！** ⚽🎮
